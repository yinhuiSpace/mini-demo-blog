import{d as V,e as f,v as A,p as j,c as i,b as r,w as g,a as y,E as m,r as _,n as K,o as n,h as e,t as d,l as E,_ as L,j as M,k as h,u as I,x as P,F as B,i as N,m as D,y as q,z as F,g as G,A as H}from"./index-D4dsPctk.js";import{V as J}from"./index-CcLFBvZZ.js";const O={id:"author"},Q=e("div",{class:"el-header"},[e("span",{class:"has-text-weight-bold"}," 关于作者 ")],-1),W={class:"has-text-centered"},X={class:"block"},Y={class:"is-size-5 mb-5"},Z={class:"columns is-mobile"},ee=e("div",{class:"column is-half"},[e("code",null," 0 "),e("p",null," 文章 ")],-1),te={class:"column is-half"},se=e("p",null," 粉丝 ",-1),oe=V({__name:"Author",props:{id:String},setup(k){const s=k,a=f({}),b=t=>{console.log(t),y.get("/user-service/author",{params:{id:t}}).then(o=>{o.data.isSuccess?(a.value=o.data.content,console.log(a.value.follow)):m.error(o.data.message)})},u=f(!1),$=()=>{u.value=!0,y.post(`/user-service/user/addFollow/${s.id}`).then(t=>{t.data.isSuccess?(m.success("关注成功"),a.value.follow=!0,a.value.fans=t.data.content,u.value=!1):(m.error(t.data.message),u.value=!1)})},l=()=>{y.delete(`/user-service/user/unFollow/${s.id}`).then(t=>{t.data.isSuccess?(m.success("取关成功"),a.value.fans=t.data.content,a.value.follow=!1,u.value=!1):(m.error(t.data.message),u.value=!1)})},c=A(s,"id");console.log(c.value),b(c.value);const p=t=>{E.push({path:`/person/${t}`})};return(t,o)=>{const w=_("el-avatar"),C=_("el-card"),S=K("loading");return j((n(),i("section",O,[r(C,{class:"",shadow:"never"},{default:g(()=>[Q,e("div",W,[e("div",X,[r(w,{onClick:o[0]||(o[0]=z=>p(c.value)),fit:"cover",size:60,src:a.value.avatar,style:{border:"solid #F0F0F2 2px",cursor:"pointer"}},null,8,["src"])]),e("p",Y,[e("span",{class:"is-size-7 has-text-grey",style:{cursor:"pointer"},onClick:o[1]||(o[1]=z=>p(c.value))},d(a.value.nickname),1)]),e("div",Z,[ee,e("div",te,[e("code",null,d(a.value.fans),1),se])]),e("div",null,[a.value.follow?(n(),i("button",{key:0,class:"button is-success is-fullwidth",onClick:l}," 已关注 ")):(n(),i("button",{key:1,class:"button is-link is-fullwidth",onClick:$}," 关注 "))])])]),_:1})])),[[S,u.value]])}}}),ae={},ne=e("div",{class:"el-header"},[e("span",{class:"has-text-weight-bold"}," 相关文章 ")],-1),le=e("div",null,[e("p",{class:"block"},[e("span",{class:"tag"}," 1 "),h(" 文章标题 ")])],-1);function ce(k,s){const a=_("el-card");return n(),M(a,{shadow:"never"},{default:g(()=>[ne,le]),_:1})}const ie=L(ae,[["render",ce]]),re={key:0,class:"media"},de={class:"media-content"},ue={class:"level"},_e={class:"level-left"},ve={key:1},me={class:"has-text-grey"},he={class:"media-left"},pe={class:"block"},fe={class:"media-content"},ge={class:"content"},ye=["onClick"],be={class:"ml-2 has-text-grey is-size-7"},$e=e("br",null,null,-1),ke={key:0,class:"content",style:{"background-color":"#d2cdcd",padding:"2vh","border-radius":"5px"}},xe={style:{color:"#3C88C0"}},we={style:{color:"#3C88C0"}},Ce=V({__name:"Comment",props:{id:String},setup(k){const s=k,a=A(s,"id"),b=f([]),u=t=>{y.get("/comment-service/comment/commentList",{params:{articleId:t,pageNum:1,pageSize:10}}).then(o=>{o.data.isSuccess?b.value=o.data.content.rows:m.error(o.data.message)})};u(a.value);const $=()=>{c.value=!0;const t=l.value;l.value="",y.post("/comment-service/comment",{articleId:s.id,type:0,rootId:-1,toCommentId:-1,toCommentUserId:-1,content:t}).then(o=>{o.data.isSuccess?(m.success("评论成功"),u(a.value),c.value=!1):m.error(o.data.message)})},l=f(""),c=f(!1),p=t=>{E.push({path:`/person/${t}`})};return(t,o)=>{const w=_("b-input"),C=_("b-field"),S=_("b-button"),z=_("router-link"),T=_("el-avatar");return n(),i(B,null,[I(D)().token!=null&&I(D)().token.trim().length>0?(n(),i("article",re,[e("div",de,[e("form",{onSubmit:P($,["prevent"])},[r(C,null,{default:g(()=>[r(w,{modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=v=>l.value=v),modelModifiers:{lazy:!0},type:"textarea",maxlength:"400",placeholder:"请输入你的评论",disabled:c.value,onKeydown:q($,["enter"])},null,8,["modelValue","disabled"])]),_:1}),e("nav",ue,[e("div",_e,[r(S,{type:"is-primary","native-type":"submit",class:"level-item",disabled:c.value||l.value.trim().length==0},{default:g(()=>[h(" 发表 ")]),_:1},8,["disabled"])])])],32)])])):(n(),i("div",ve,[e("p",me,[h(" 请先 "),r(z,{to:"/login"},{default:g(()=>[h(" 登录 ")]),_:1}),h(" 后评论 ")])])),(n(!0),i(B,null,N(b.value,(v,U)=>(n(),i("article",{key:U,class:"media"},[e("figure",he,[e("div",pe,[r(T,{onClick:x=>p(v.createBy),fit:"cover",size:50,src:v.avatar,style:{border:"solid #F0F0F2 2px",cursor:"pointer"}},null,8,["onClick","src"])])]),e("div",fe,[e("div",ge,[e("p",null,[e("strong",{style:{cursor:"pointer"},onClick:x=>p(v.createBy)},d(v.username),9,ye),e("small",be,d(v.createTime),1),$e,h(" "+d(v.content),1)])]),v.children.length>0?(n(),i("div",ke,[(n(!0),i(B,null,N(v.children,(x,R)=>(n(),i("p",{key:R},[e("span",xe,d(x.username),1),h(" 回复 "),e("span",we,d(x.toCommentUsername),1),h(" : "+d(x.content),1)]))),128))])):F("",!0)])]))),128))],64)}}}),Se={class:"columns",style:{"margin-top":"10px"}},ze={class:"column is-three-quarters"},Be={class:"el-header has-text-centered"},Fe={class:"is-size-5 has-text-weight-bold"},Ve={class:"has-text-grey is-size-7 mt-3"},Ie=e("div",{id:"preview"},null,-1),Ne={class:"level has-text-grey is-size-7 mt-6"},De={class:"level-left"},Ae={class:"level-item"},Ee={key:0,class:"column"},Ue=V({__name:"Detail",setup(k){const s=f({}),a=H(),b=()=>{y.get(`/blog-service/article/details/${a.params.id}`).then(l=>{l.data.isSuccess?(s.value=l.data.content,console.log(s.value.createBy),J.preview(document.getElementById("preview"),s.value.content,{hljs:{style:"github"}}),$(s.value.createBy)):m.error(l.data.message)})},u=f({}),$=l=>{y.get("/user-service/author",{params:{id:l}}).then(c=>{c.data.isSuccess?u.value=c.data.content:m.error(c.data.message)})};return G(()=>{b()}),(l,c)=>{const p=_("el-divider"),t=_("b-tag"),o=_("el-card");return n(),i("div",Se,[e("div",ze,[r(o,{class:"box",shadow:"never"},{default:g(()=>[e("div",Be,[e("p",Fe,d(s.value.title),1),e("div",Ve,[e("span",null," 时间："+d(s.value.createTime),1),r(p,{direction:"vertical"}),e("span",null,"发布者："+d(u.value.nickname),1),r(p,{direction:"vertical"}),e("span",null,"浏览量："+d(s.value.viewCount),1)])]),Ie,e("nav",Ne,[e("div",De,[e("p",Ae,[r(t,{type:"is-info is-light mr-1"},{default:g(()=>[h(d(s.value.categoryName),1)]),_:1})])])])]),_:1}),s.value.id?(n(),M(Ce,{key:0,id:s.value.id},null,8,["id"])):F("",!0)]),s.value.createBy?(n(),i("div",Ee,[r(oe,{id:s.value.createBy},null,8,["id"]),r(ie)])):F("",!0)])}}});export{Ue as default};
