import{e as o,m as q,a as y,E as c,l as I,d as E,c as P,h as g,b as a,w as r,r as m,n as U,o as h,p as B,u as l,j as S,k as b,t as D}from"./index-D4dsPctk.js";const s=o({username:"",nickname:"",password:"",checkPass:"",email:"",phone:"未知",verifyCode:""}),N=(u,n,e)=>{n===""?e(new Error("请再次输入密码")):n!==s.value.password?e(new Error("两次输入密码不一致")):e()},V=o(!1),R=o({username:[{required:!0,message:"请输入账号",trigger:"blur"},{min:2,max:10,message:"长度在2到10个字符之间",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"长度在6到20个字符之间",trigger:"blur"}],checkPass:[{required:!0,message:"请再次输入密码",trigger:"blur"},{validator:N,trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{min:11,max:11,message:"手机号格式错误",trigger:"blur"}],verifyCode:[{required:!0,message:"请输入验证码",trigger:"blur"}]}),w=o({}),L=u=>{q().removeLogin(),u.validate(n=>{if(n)return y.post("/user-service/user/register",s.value).then(e=>{e.data.isSuccess?(c.success("注册成功"),I.push({path:"/login"}).then()):c.error(e.data.message),V.value=!1})})},$=o(!1),p=o(!0),v=o("获取验证码"),f=o(60),j=()=>{p.value=!0,s.value.email===null||s.value.email.trim().length===0?c.error("请先填写邮箱"):y.post("/user-service/user/verifyCode",{email:s.value.email}).then(u=>{if(u.data.isSuccess){c.success("验证码已发送，请到邮箱查看"),p.value=!0;const n=setInterval(()=>{f.value--;const e=f.value;v.value=`${e}秒`,e<=0&&(clearInterval(n),f.value=60,v.value="重新获取",p.value=!1)},1e3)}else c.error(u.data.message)})},F=()=>{p.value=s.value.email===null||s.value.email.trim().length===0},M={class:"columns py-6"},T={class:"column is-half is-offset-one-quarter"},z=g("div",{class:"el-header has-text-centered has-text-weight-bold"}," 注册账号 ",-1),G=E({__name:"Register",setup(u){return(n,e)=>{const d=m("el-input"),i=m("el-form-item"),_=m("el-button"),x=m("el-form"),k=m("el-card"),C=U("loading");return h(),P("div",M,[g("div",T,[a(k,{shadow:"never"},{default:r(()=>[z,g("div",null,[B((h(),S(x,{ref_key:"formInstance",ref:w,model:l(s),rules:l(R),"label-width":"100px",class:"","status-icon":""},{default:r(()=>[a(i,{label:"账号名",prop:"username"},{default:r(()=>[a(d,{modelValue:l(s).username,"onUpdate:modelValue":e[0]||(e[0]=t=>l(s).username=t),autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(i,{label:"邮箱",prop:"email",style:{display:"flex"}},{default:r(()=>[a(d,{modelValue:l(s).email,"onUpdate:modelValue":e[1]||(e[1]=t=>l(s).email=t),autocomplete:"off",style:{flex:"1"},onInput:l(F)},null,8,["modelValue","onInput"]),a(_,{type:"warning",loading:l($),disabled:l(p),onClick:l(j),style:{flex:"1"}},{default:r(()=>[b(D(l(v)),1)]),_:1},8,["loading","disabled","onClick"])]),_:1}),a(i,{label:"验证码",prop:"verifyCode"},{default:r(()=>[a(d,{modelValue:l(s).verifyCode,"onUpdate:modelValue":e[2]||(e[2]=t=>l(s).verifyCode=t),placeholder:"请输入验证码",minlength:"6",maxlength:"6"},null,8,["modelValue"])]),_:1}),a(i,{label:"密码",prop:"password"},{default:r(()=>[a(d,{modelValue:l(s).password,"onUpdate:modelValue":e[3]||(e[3]=t=>l(s).password=t),type:"password","show-password":"",autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(i,{label:"确认密码",prop:"checkPass"},{default:r(()=>[a(d,{modelValue:l(s).checkPass,"onUpdate:modelValue":e[4]||(e[4]=t=>l(s).checkPass=t),type:"password","show-password":"",autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(i,null,{default:r(()=>[a(_,{type:"primary",onClick:e[5]||(e[5]=t=>l(L)(l(w)))},{default:r(()=>[b(" 立即注册 ")]),_:1})]),_:1})]),_:1},8,["model","rules"])),[[C,l(V)]])])]),_:1})])])}}});export{G as default};
