import{a as I}from"./index-BgbCg4-D.js";import{r as g,E as k,d as ee,c as y,w as a,a as s,q as le,o as f,b as e,u as l,i,g as h,h as ae,F as oe,e as V,s as D,f as R,t as te,x as ne,y as L}from"./index-DhBAbreQ.js";import{_ as se}from"./Page.vue_vue_type_script_setup_true_lang-juzETF4l.js";import"./user-DyNFqZc8.js";const C=g({nickname:"",pageNum:"",pageSize:""}),ue=[{prop:"id",label:"id",width:"180"},{prop:"avatar",label:"头像",width:"150"},{prop:"username",label:"用户名",width:"150"},{prop:"nickname",label:"昵称",width:"150"},{prop:"email",label:"邮箱",width:"180"},{prop:"phone",label:"电话",width:"150"},{prop:"gender",label:"性别",width:"150"},{prop:"status",label:"是否禁用",width:"100"},{prop:"action",label:"操作",width:"180",fixed:"right"}],G=g([]),H=g(1),c=g(!1),w=()=>{I.get("/user-service/user/list",{params:C.value}).then(n=>{n.data.isSuccess?(G.value=n.data.content.rows,H.value=n.data.content.total):k.error(n.data.message)})},u=g({username:"",nickname:"",password:"",email:"",phone:"",gender:"",avatar:""}),M={username:[{required:!0,trigger:"change",message:"用户名不能为空"}],password:[{required:!0,trigger:"change",message:"密码不能为空"}],email:[{required:!0,trigger:"change",message:"邮箱不能为空"}],phone:[{required:!0,trigger:"change",message:"手机号不能为空"}]},A=g(),b=g(!1),de=n=>{c.value=!0,n.validate(N=>{N?I.post("/user-service/user/add",u.value).then(S=>{S.data.isSuccess?(u.value={},k.success("增加成功！"),c.value=!1,w(),b.value=!1):(k.error(S.data.message),c.value=!1)}):(k.error("请填写完整信息"),c.value=!1)})},J=g(""),T=()=>{c.value=!0,I.delete(`/user-service/user/${J.value}`).then(n=>{n.data.isSuccess?(c.value=!1,k.success("删除成功"),_.value=!1,w()):(k.error(n.data.message),c.value=!1,_.value=!1)})},_=g(!1),re=n=>{J.value=n,_.value=!0},U=g(!1),d=g({}),ie=n=>{d.value=n,U.value=!0},pe=()=>{c.value=!0,I.put("/user-service/user/update",d.value).then(n=>{n.data.isSuccess?(c.value=!1,k.success("更新成功"),U.value=!1,w()):(k.error(n.data.message),c.value=!1)})},me={key:0},fe={key:1},ce={key:2},ve=V("span",null," 确定删除该记录吗 ",-1),_e={class:"dialog-footer"},ge={style:{flex:"45",display:"flex","align-items":"center","justify-content":"center"}},Ve=["src"],we={class:"dialog-footer"},ke=V("span",null," 确定删除该记录吗 ",-1),ye={class:"dialog-footer"},he={style:{flex:"45",display:"flex","align-items":"center","justify-content":"center"}},be=["src"],Ue={class:"dialog-footer"},qe=ee({__name:"User",setup(n){const N=p=>{C.value.pageNum=p,w()},S=p=>{C.value.pageSize=p,w()};return w(),(p,t)=>{const v=s("el-input"),K=s("el-col"),m=s("el-button"),O=s("el-row"),Q=s("el-switch"),W=s("el-table-column"),X=s("el-table"),$=s("el-dialog"),r=s("el-form-item"),q=s("el-radio"),E=s("el-radio-group"),z=s("el-icon"),P=s("el-upload"),j=s("el-form"),Y=s("el-card"),F=le("loading");return f(),y(Y,null,{default:a(()=>[e(O,{gutter:20},{default:a(()=>[e(K,{span:7},{default:a(()=>[e(v,{placeholder:"搜索框",clearable:"",modelValue:l(C).nickname,"onUpdate:modelValue":t[0]||(t[0]=o=>l(C).nickname=o),onInput:l(w)},null,8,["modelValue","onInput"])]),_:1}),e(m,{type:"primary",icon:"Search",onClick:l(w)},{default:a(()=>[i(" 搜索 ")]),_:1},8,["onClick"]),e(m,{type:"success",icon:"CirclePlus",onClick:t[1]||(t[1]=o=>b.value=!0)},{default:a(()=>[i(" 添加用户 ")]),_:1})]),_:1}),e(X,{data:l(G),stripe:"",style:{width:"100%","margin-top":"30px"}},{default:a(()=>[(f(!0),h(oe,null,ae(l(ue),(o,Z)=>(f(),y(W,{key:Z,prop:o.prop,label:o.label,width:o.width,fixed:o.fixed},{default:a(x=>[o.prop==="action"?(f(),h("div",me,[e(m,{type:"primary",icon:"Edit",circle:"",onClick:B=>l(ie)(x.row)},null,8,["onClick"]),e(m,{type:"danger",icon:"Delete",circle:"",onClick:B=>l(re)(x.row.id)},null,8,["onClick"])])):o.prop==="status"?(f(),h("div",fe,[e(Q,{modelValue:x.row.status,"onUpdate:modelValue":B=>x.row.status=B,"active-value":"1","inactive-value":"0"},null,8,["modelValue","onUpdate:modelValue"])])):o.prop==="gender"?(f(),h("div",ce,[V("span",null,te(x.row.gender==="0"?"男":"女"),1)])):ne("",!0)]),_:2},1032,["prop","label","width","fixed"]))),128))]),_:1},8,["data"]),e($,{modelValue:l(_),"onUpdate:modelValue":t[3]||(t[3]=o=>D(_)?_.value=o:null),title:"警告",width:"500","align-center":""},{footer:a(()=>[V("div",_e,[e(m,{onClick:t[2]||(t[2]=o=>_.value=!1)},{default:a(()=>[i("取消")]),_:1}),e(m,{type:"danger",onClick:l(T)},{default:a(()=>[i(" 删除 ")]),_:1},8,["onClick"])])]),default:a(()=>[ve]),_:1},8,["modelValue"]),e($,{modelValue:l(b),"onUpdate:modelValue":t[12]||(t[12]=o=>D(b)?b.value=o:null),title:"新增用户",width:"500","align-center":""},{footer:a(()=>[V("div",we,[e(m,{onClick:t[10]||(t[10]=o=>b.value=!1)},{default:a(()=>[i("取消")]),_:1}),e(m,{type:"primary",onClick:t[11]||(t[11]=o=>l(de)(l(A)))},{default:a(()=>[i(" 保存 ")]),_:1})])]),default:a(()=>[V("div",ge,[R((f(),y(j,{ref_key:"formInstance",ref:A,model:l(u),style:{width:"80%"},rules:l(M)},{default:a(()=>[e(r,{prop:"username"},{default:a(()=>[e(v,{placeholder:"请输入账号",type:"text",autocomplete:"off",modelValue:l(u).username,"onUpdate:modelValue":t[4]||(t[4]=o=>l(u).username=o),"prefix-icon":"user"},null,8,["modelValue"])]),_:1}),e(r,{prop:"nickname"},{default:a(()=>[e(v,{placeholder:"请输入昵称",type:"text",autocomplete:"off",modelValue:l(u).nickname,"onUpdate:modelValue":t[5]||(t[5]=o=>l(u).nickname=o),"prefix-icon":"user"},null,8,["modelValue"])]),_:1}),e(r,{prop:"password"},{default:a(()=>[e(v,{placeholder:"请输入密码",type:"password",autocomplete:"off","show-password":"",modelValue:l(u).password,"onUpdate:modelValue":t[6]||(t[6]=o=>l(u).password=o),"prefix-icon":"lock"},null,8,["modelValue"])]),_:1}),e(r,{prop:"username"},{default:a(()=>[e(v,{placeholder:"请输入邮箱",type:"text",autocomplete:"off",modelValue:l(u).email,"onUpdate:modelValue":t[7]||(t[7]=o=>l(u).email=o),"prefix-icon":"user"},null,8,["modelValue"])]),_:1}),e(r,{prop:"username"},{default:a(()=>[e(v,{placeholder:"请输入电话",type:"text",autocomplete:"off",modelValue:l(u).phone,"onUpdate:modelValue":t[8]||(t[8]=o=>l(u).phone=o),"prefix-icon":"user"},null,8,["modelValue"])]),_:1}),e(r,{prop:"gender"},{default:a(()=>[e(E,{modelValue:l(u).gender,"onUpdate:modelValue":t[9]||(t[9]=o=>l(u).gender=o)},{default:a(()=>[e(q,{value:0},{default:a(()=>[i("男")]),_:1}),e(q,{value:1},{default:a(()=>[i("女")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(r,{prop:"avatar"},{default:a(()=>[e(P,{class:"avatar-uploader",action:"https://run.mocky.io/v3/9d059bf9-4660-45f2-925d-ce80ad6c4d15","show-file-list":!1,"on-success":p.handleAvatarSuccess,"before-upload":p.beforeAvatarUpload},{default:a(()=>[p.imageUrl?(f(),h("img",{key:0,src:p.imageUrl,class:"avatar",alt:""},null,8,Ve)):(f(),y(z,{key:1,class:"avatar-uploader-icon"},{default:a(()=>[e(l(L))]),_:1}))]),_:1},8,["on-success","before-upload"])]),_:1})]),_:1},8,["model","rules"])),[[F,l(c)]])])]),_:1},8,["modelValue"]),e($,{modelValue:l(_),"onUpdate:modelValue":t[14]||(t[14]=o=>D(_)?_.value=o:null),title:"警告",width:"500","align-center":""},{footer:a(()=>[V("div",ye,[e(m,{onClick:t[13]||(t[13]=o=>_.value=!1)},{default:a(()=>[i("取消")]),_:1}),e(m,{type:"danger",onClick:l(T)},{default:a(()=>[i(" 删除 ")]),_:1},8,["onClick"])])]),default:a(()=>[ke]),_:1},8,["modelValue"]),e($,{modelValue:l(U),"onUpdate:modelValue":t[22]||(t[22]=o=>D(U)?U.value=o:null),title:"修改用户",width:"500","align-center":""},{footer:a(()=>[V("div",Ue,[e(m,{onClick:t[21]||(t[21]=o=>U.value=!1)},{default:a(()=>[i("取消")]),_:1}),e(m,{type:"primary",onClick:l(pe)},{default:a(()=>[i(" 保存 ")]),_:1},8,["onClick"])])]),default:a(()=>[V("div",he,[R((f(),y(j,{ref_key:"formInstance",ref:A,model:l(d),style:{width:"80%"},rules:l(M)},{default:a(()=>[e(r,{prop:"username"},{default:a(()=>[e(v,{placeholder:"请输入账号",type:"text",autocomplete:"off",modelValue:l(d).username,"onUpdate:modelValue":t[15]||(t[15]=o=>l(d).username=o),"prefix-icon":"user"},null,8,["modelValue"])]),_:1}),e(r,{prop:"nickname"},{default:a(()=>[e(v,{placeholder:"请输入昵称",type:"text",autocomplete:"off",modelValue:l(d).nickname,"onUpdate:modelValue":t[16]||(t[16]=o=>l(d).nickname=o),"prefix-icon":"user"},null,8,["modelValue"])]),_:1}),e(r,{prop:"password"},{default:a(()=>[e(v,{placeholder:"请输入密码",type:"password",autocomplete:"off","show-password":"",modelValue:l(d).password,"onUpdate:modelValue":t[17]||(t[17]=o=>l(d).password=o),"prefix-icon":"lock"},null,8,["modelValue"])]),_:1}),e(r,{prop:"username"},{default:a(()=>[e(v,{placeholder:"请输入邮箱",type:"text",autocomplete:"off",modelValue:l(d).email,"onUpdate:modelValue":t[18]||(t[18]=o=>l(d).email=o),"prefix-icon":"user"},null,8,["modelValue"])]),_:1}),e(r,{prop:"username"},{default:a(()=>[e(v,{placeholder:"请输入电话",type:"text",autocomplete:"off",modelValue:l(d).phone,"onUpdate:modelValue":t[19]||(t[19]=o=>l(d).phone=o),"prefix-icon":"user"},null,8,["modelValue"])]),_:1}),e(r,{prop:"gender"},{default:a(()=>[e(E,{modelValue:l(d).gender,"onUpdate:modelValue":t[20]||(t[20]=o=>l(d).gender=o)},{default:a(()=>[e(q,{value:0},{default:a(()=>[i("男")]),_:1}),e(q,{value:1},{default:a(()=>[i("女")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(r,{prop:"avatar"},{default:a(()=>[e(P,{class:"avatar-uploader",action:"","show-file-list":!1,"on-success":p.handleAvatarSuccess,"http-request":p.handleUpload,headers:p.header},{default:a(()=>[p.url?(f(),h("img",{key:0,src:p.url,class:"avatar",alt:""},null,8,be)):(f(),y(z,{key:1,class:"avatar-uploader-icon"},{default:a(()=>[e(l(L))]),_:1}))]),_:1},8,["on-success","http-request","headers"])]),_:1})]),_:1},8,["model","rules"])),[[F,l(c)]])])]),_:1},8,["modelValue"]),e(se,{total:l(H),handlePageNum:N,handlePageSize:S},null,8,["total"])]),_:1})}}});export{qe as default};
